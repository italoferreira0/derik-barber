{% extends 'base_funcionario.html' %}
{% load static %}

{% block content %}
{% csrf_token %}
<div class="row mt-5 mb-5">
    <div class="col-12">
        <div class="card shadow">
            <div class="card-header text-white" style="background-color: #00366c">
                <h4 class="mb-0">
                    <i class="fas fa-history me-2"></i>
                    Histórico de Agendamentos
                </h4>
            </div>
            <div class="card-body">
                <!-- Wrapper responsivo -->
                <div class="table-responsive">
                    <table id="historicoTable" 
                           class="table table-striped table-bordered nowrap" 
                           style="width:100%">
                        <thead class="table-dark">
                            <tr>
                                <th>Cliente</th>
                                <th>Telefone</th>
                                <th>Serviço</th>
                                <th>Preço</th>
                                <th>Data</th>
                                <th>Hora</th>
                                <th>Observações</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for agendamento in agendamentos %}
                            <tr>
                                <td>{{ agendamento.cliente.nome }}</td>
                                <td>{{ agendamento.cliente.telefone }}</td>
                                <td>{{ agendamento.servico.nome }}</td>
                                <td>R$ {{ agendamento.servico.preco|floatformat:2 }}</td>
                                <td>{{ agendamento.data|date:"d/m/Y" }}</td>
                                <td>{{ agendamento.hora|time:"H:i" }}</td>
                                <td>{{ agendamento.observacoes|default:"-" }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- DataTables CSS -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap5.min.css">

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<!-- DataTables JS -->
<script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.5.0/js/responsive.bootstrap5.min.js"></script>

<script>
$(document).ready(function() {
  $('#historicoTable').DataTable({
    scrollX: true,
    autoWidth: false,
    language: {
      "sEmptyTable":     "Nenhum registro encontrado",
      "sInfo":           "Mostrando de _START_ até _END_ de _TOTAL_ registros",
      "sInfoEmpty":      "Mostrando 0 até 0 de 0 registros",
      "sInfoFiltered":   "(Filtrados de _MAX_ registros)",
      "sLengthMenu":     "Mostrar _MENU_ registros",
      "sLoadingRecords": "Carregando...",
      "sProcessing":     "Processando...",
      "sSearch":         "Buscar:",
      "sZeroRecords":    "Nenhum registro encontrado",
      "oPaginate": {
          "sNext":     "Próximo",
          "sPrevious": "Anterior",
          "sFirst":    "Primeiro",
          "sLast":     "Último"
      },
      "oAria": {
          "sSortAscending":  ": Ordenar colunas de forma ascendente",
          "sSortDescending": ": Ordenar colunas de forma descendente"
      }
    }
  });
});
</script>
{% endblock %}
